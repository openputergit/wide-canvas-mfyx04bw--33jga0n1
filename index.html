<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoLearn - Gamified Environmental Education</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

<style>
.glass {
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.18);
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
}

.progress-bar {
    transition: width 0.5s ease-in-out;
}

body {
    background: linear-gradient(45deg, #184e77, #1a759f, #168aad, #34a0a4);
    background-size: 400% 400%;
    animation: gradient 15s ease infinite;
    font-family: 'Poppins', sans-serif;
}

@keyframes gradient {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

.mission-card:hover {
    transform: translateY(-5px);
    transition: transform 0.3s ease;
}

.chatbot-container {
    max-height: 400px;
    overflow-y: auto;
}
</style>
</head>
<body class="min-h-screen text-white">
    <div id="app" class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="glass rounded-xl p-6 mb-8">
            <div class="flex justify-between items-center">
                <h1 class="text-3xl font-bold">EcoLearn</h1>
                <div class="flex items-center gap-4">
                    <div class="text-right">
                        <p class="text-sm">Level {{userLevel}}</p>
                        <div class="w-32 bg-white/30 rounded-full h-2">
                            <div class="bg-green-400 h-2 rounded-full progress-bar" :style="{width: xpProgress + '%'}"></div>
                        </div>
                    </div>
                    <div class="glass rounded-full p-2">
                        <i class="bi bi-person-circle text-2xl"></i>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Games Section -->
            <div class="glass rounded-xl p-6">
                <h2 class="text-xl font-semibold mb-4">Eco Games</h2>
                <div class="space-y-4">
                    <button @click="startGame('recycling')" class="w-full glass hover:bg-white/30 rounded-lg p-4 flex items-center gap-3">
                        <i class="bi bi-recycle text-2xl"></i>
                        <div class="text-left">
                            <h3 class="font-medium">Recycling Hero</h3>
                            <p class="text-sm opacity-75">Sort waste items correctly</p>
                        </div>
                    </button>
                    <button @click="startGame('energy')" class="w-full glass hover:bg-white/30 rounded-lg p-4 flex items-center gap-3">
                        <i class="bi bi-lightning-charge text-2xl"></i>
                        <div class="text-left">
                            <h3 class="font-medium">Energy Guardian</h3>
                            <p class="text-sm opacity-75">Manage renewable energy sources</p>
                        </div>
                    </button>
                </div>
            </div>

            <!-- Missions Section -->
            <div class="glass rounded-xl p-6">
                <h2 class="text-xl font-semibold mb-4">Eco Missions</h2>
                <div class="space-y-4">
                    <div v-for="mission in missions" :key="mission.id" class="mission-card glass rounded-lg p-4">
                        <div class="flex justify-between items-start">
                            <div>
                                <h3 class="font-medium">{{mission.title}}</h3>
                                <p class="text-sm opacity-75">{{mission.description}}</p>
                            </div>
                            <button @click="completeMission(mission.id)" 
                                    :class="mission.completed ? 'bg-green-500' : 'bg-white/30'"
                                    class="rounded-full p-2">
                                <i class="bi" :class="mission.completed ? 'bi-check-lg' : 'bi-arrow-right'"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI Chatbot Section -->
            <div class="glass rounded-xl p-6">
                <h2 class="text-xl font-semibold mb-4">EcoBot Assistant</h2>
                <div class="chatbot-container mb-4">
                    <div v-for="message in chatMessages" :key="message.id" 
                         :class="message.sender === 'user' ? 'ml-auto bg-white/30' : 'bg-white/20'"
                         class="rounded-lg p-3 mb-2 max-w-[80%]">
                        {{message.text}}
                    </div>
                </div>
                <div class="flex gap-2">
                    <input v-model="userMessage" @keyup.enter="sendMessage" 
                           class="flex-1 glass rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-white/50" 
                           placeholder="Ask about environment...">
                    <button @click="sendMessage" class="glass rounded-lg p-2 hover:bg-white/30">
                        <i class="bi bi-send"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
    const { createApp } = Vue

    createApp({
        data() {
            return {
                userLevel: 1,
                xpProgress: 60,
                userMessage: '',
                chatMessages: [],
                missions: [
                    {
                        id: 1,
                        title: 'Plant a Tree',
                        description: 'Plant a tree in your local area',
                        completed: false
                    },
                    {
                        id: 2,
                        title: 'Zero Waste Day',
                        description: 'Go one day without producing waste',
                        completed: false
                    },
                    {
                        id: 3,
                        title: 'Energy Audit',
                        description: 'Complete home energy audit',
                        completed: false
                    }
                ]
            }
        },
        methods: {
            async startGame(type) {
                // Game logic would be implemented here
                alert(`Starting ${type} game...`)
            },
            async completeMission(id) {
                const mission = this.missions.find(m => m.id === id)
                if (mission) {
                    mission.completed = !mission.completed
                    if (mission.completed) {
                        this.xpProgress += 20
                        if (this.xpProgress >= 100) {
                            this.userLevel++
                            this.xpProgress = 0
                        }
                        // Save progress to MongoDB
                        await this.saveProgress()
                    }
                }
            },
            async sendMessage() {
                if (!this.userMessage.trim()) return

                // Add user message
                this.chatMessages.push({
                    id: Date.now(),
                    sender: 'user',
                    text: this.userMessage
                })

                // Call AI endpoint
                try {
                    const response = await fetch('https://r0c8kgwocscg8gsokogwwsw4.zetaverse.one/ai', {
                        method: 'POST',
                        headers: {
                            'Authorization': 'Bearer pypAj9jDxLhgUbCgVXlZpeBP79v2',
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            messages: [{
                                role: 'user',
                                content: [{
                                    type: 'text',
                                    text: this.userMessage
                                }]
                            }]
                        })
                    })

                    const data = await response.json()
                    
                    // Add bot response
                    this.chatMessages.push({
                        id: Date.now() + 1,
                        sender: 'bot',
                        text: data.message
                    })
                } catch (error) {
                    console.error('Error:', error)
                }

                this.userMessage = ''
            },
            async saveProgress() {
                try {
                    await fetch('https://r0c8kgwocscg8gsokogwwsw4.zetaverse.one/mongodb', {
                        method: 'POST',
                        headers: {
                            'Authorization': 'Bearer pypAj9jDxLhgUbCgVXlZpeBP79v2',
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            appSlug: 'my-app-database-1234',
                            action: 'create',
                            collection: 'user_progress',
                            data: {
                                level: this.userLevel,
                                xp: this.xpProgress,
                                missions: this.missions
                            }
                        })
                    })
                } catch (error) {
                    console.error('Error saving progress:', error)
                }
            }
        },
        mounted() {
            // Load user progress from MongoDB
            fetch('https://r0c8kgwocscg8gsokogwwsw4.zetaverse.one/mongodb', {
                method: 'POST',
                headers: {
                    'Authorization': 'Bearer pypAj9jDxLhgUbCgVXlZpeBP79v2',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    appSlug: 'my-app-database-1234',
                    action: 'read',
                    collection: 'user_progress'
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.result && data.result.length > 0) {
                    const progress = data.result[0]
                    this.userLevel = progress.level
                    this.xpProgress = progress.xp
                    this.missions = progress.missions
                }
            })
            .catch(error => console.error('Error loading progress:', error))
        }
    }).mount('#app')
    </script>
<script>document.body.addEventListener('wheel', e => { if (!e.ctrlKey) return; e.preventDefault(); return }, { passive: false })</script>
	</body>
</html>